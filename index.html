<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
  </head>
  <body>
    <h1>Group D</h1>
    <h2>Infovis2020 Group Project</h2>
    <select name="select1" id="select1"></select>
    <select name="select2" id="select2"></select>
    <div  style="float: left">
      <div><b>Write Byte Usage per OST Nodes</b></div>
      <svg id="bar"></svg>
    </div> 
  </body>

  <script>
      let dataArr;
      function appendOptions() {
        console.log("going to append option to select1");
        $.getJSON("/appendOptions", function(json) {
          json.forEach((row) => {
            d3.select("#select1")
              .append("option")
              .property('value', row.progName)
              .text(row.progName);
          });
        });
      }

      function getData() {
          console.log("going to be db data")
          let progName = {progName: "pw.x"}
        $.getJSON("/getData", progName, function (json) {
            console.log("hi");
            console.log(json);
        });
      }

      $(function() { appendOptions();});
  </script>

  <!-- hrchung -->
 <script>
      function getIntervalJobs(progName, jobID) {
         let q_input = {progName: progName, jobID : jobID}
         //let q_input = {progName: "cp2k.popt"}
         $.getJSON("/getIntervalJobs", q_input, function (json) {
            var intervalJobs = json;
            console.log(intervalJobs);
            var totalOST = {};
            intervalJobs.map(row => {var lists = row['ostlist'].split(" ");  lists.map(ost => { if (!(ost in totalOST)) totalOST[ost] = {}; totalOST[ost][row['jobID']] = row['ossWriteMean']; })  });
            totalOST = Object.getOwnPropertyNames(totalOST).map(function(e) { totalOST[e]['ostID']=e; console.log(totalOST[e]); return totalOST[e]});
            console.log(totalOST);

            //barChart.initialize();
        })};
      var progName = "cp2k.popt";
      var jobID = 6477576;
      $(function() {  getIntervalJobs(progName, jobID);});
 </script>
</html>
